import{getTypeOfCssProperty,waitForEl}from"./helpers.js?ver=2.6.1";let sharedFunctions={previewClass:function(e){var t=this.getCurrentElementId();this.getIframeDocument().querySelector(t).classList.add(e)},removePreviewClass:function(e){var t=this.getCurrentElementId();this.isClassAlreadyActive(e)||this.getIframeDocument().querySelector(t).classList.remove(e)},getActiveClassesAsArray:function(){return this.getIframeDocument().querySelector(this.getCurrentElementId()).classList.value.split(" ")}},bricksFunctions={name:"bricks",isBricks:!0,deleteClassListItemSelector:"span[data-balloon='Remove']",getIframeDocument:function(){return document.getElementById("bricks-builder-iframe").contentWindow.document},mainInputSelector:"div.active-class",mainPanelSelector:"#bricks-panel-inner",classInputSelector:"#bricks-panel-element-classes > div.bricks-control-popup.bottom > div.input-wrapper > input[type=text]",saveClassSelector:".input-wrapper .actions .create",getVueObj:function(){return document.querySelector("body > .brx-body.main").__vue_app__},getCurrentElementId:function(){var e=this.getVueObj(),t=e.config.globalProperties.$_activeElement._value.settings._cssId;return t?"#"+t:"#brxe-"+e.config.globalProperties.$_activeElement._value.id},findUnusedClass:function(e){var t=this.getUnusedClassListItems();if(null!=t)for(var r of t)if(r.firstElementChild.textContent==e)return r;return null},addClass:function(t){this.removePreviewClass(t);var e,r=document.querySelector("[data-v-app]").__vue_app__.config.globalProperties.$_state;let o=r.activeElement.settings._cssGlobalClasses,n=!1,s=t;return r.globalClasses.forEach(e=>{e.name===t&&(n=!0,s=e.id)}),n||(e={id:t,name:t,settings:Array(0)},r.globalClasses.push(e)),o||(r.activeElement.settings._cssGlobalClasses=[],o=r.activeElement.settings._cssGlobalClasses),o?.includes(s)||o.push(s),!0},sanitizeCssProperty:(e,t)=>{switch(e){case"_width":return"width";case"_height":return"height";case"_widthMin":return"min-width";case"_heightMin":return"min-height";case"_widthMax":return"max-width";case"_heightMax":return"max-height";case"_top":return"top";case"_right":return"right";case"_bottom":return"bottom";case"_left":return"left";case"width-0":return"border-top-width";case"width-1":return"border-right-width";case"width-2":return"border-bottom-width";case"width-3":return"border-left-width";case"radius-0":return"border-top-left-radius";case"radius-1":return"border-top-right-radius";case"radius-2":return"border-bottom-right-radius";case"radius-3":return"border-bottom-left-radius";case"_typography":return"color";case"_background":return"background-color";case"_border":return"border-color";case"_columnGap":return"column-gap";case"_rowGap":return"row-gap";case"_gradient":return"";case"_border":return"border-color";case"_gridTemplateColumns":return"grid-template-columns";case"_gridGap":return"grid-gap";case"_gridTemplateRows":return"grid-template-rows";case"radius-top":return"border-top-left-radius";case"radius-right":return"border-top-right-radius";case"radius-left":return"border-bottom-left-radius";case"radius-bottom":return"border-bottom-right-radius";default:return"_"==e.charAt(0)?"":e}},getCurrentCssProperty:function(e){let t="";var r=e?.parentElement?.parentElement.classList.contains("handle")?e?.parentElement?.parentElement:null;return r&&r.title?t=r.title:e.parentElement.parentElement.querySelector("label[for]")&&!e.classList.contains("has-dynamic-picker")&&"raw"!==e.parentElement.parentElement.querySelector("label[for]").getAttribute("for").slice(0,3)?t=e.parentElement.parentElement.querySelector("label[for]").getAttribute("for"):e.closest("[controlkey]")?"radius"==(t=e.closest("[controlkey]").getAttribute("controlkey")??"")&&(t="radius-"+e.closest(".handle").classList[1]??""):e.closest(".control-group")&&(t=e.closest(".control-group").querySelector("[data-controlkey]").getAttribute("data-controlkey")??""),this.sanitizeCssProperty(t,e)},removeClass:function(t){var e=this.getClassListItem(t);if(null==e)return!1;e.querySelector(this.deleteClassListItemSelector).click();let r=()=>{var e;this.getIframeDocument().querySelector(this.getCurrentElementId()).classList.contains(t)&&(null!=(e=this.getClassListItem(t))&&e.querySelector(this.deleteClassListItemSelector).click(),setTimeout(r,100))};setTimeout(r,100)},setUnitToNone:function(e){},getCurrentInputOption:function(e){var t=e.closest("[controlkey]")?e.closest("[controlkey]").getAttribute("controlkey"):null;return t&&""!=t?t:this.getCurrentCssProperty(e)},getCurrentSelector:function(){var e=document.querySelector(this.mainInputSelector).querySelector("input").getAttribute("value");return e||document.querySelector(this.mainInputSelector).querySelector("input").getAttribute("placeholder")},getClassListItem:function(e){e="."+e;var t=document.querySelectorAll("#bricks-panel-element-classes > .element-classes > li");if(null!=t)for(var r of t)if(r.firstElementChild.textContent==e)return r;return null},getUnusedClassListItems:function(){let e=document.querySelectorAll(".css-classes ul:last-child li");return 0===e.length&&(document.querySelector(this.mainInputSelector).click(),e=document.querySelectorAll(".css-classes ul:last-child li")),e},isClassAlreadyActive:function(e){return null!=this.getClassListItem(e)},initHoverPreviewEventImplementation:function(t){document.querySelector("#bricks-panel-inner").addEventListener("mouseup",e=>{null!==e.target.closest(this.mainInputSelector)&&0==e.button&&waitForEl(this.classInputSelector).then(()=>{t(),document.querySelector(this.classInputSelector).addEventListener("input",function(){var e=document.querySelector(".css-classes ul:last-child li");null!=e&&"0"!==e.getAttribute("tabindex")&&t()})})});function e(e){if("Enter"==e.key){let e=()=>{null!=document.querySelector(this.classInputSelector)?(t(),document.querySelector(this.classInputSelector).addEventListener("input",function(){var e=document.querySelector(".css-classes ul:last-child li");null!=e&&"0"!==e.getAttribute("tabindex")&&t()})):setTimeout(e,100)};null==document.querySelector(this.classInputSelector)&&setTimeout(e,100)}}document.addEventListener("keydown",e),this.getIframeDocument().addEventListener("keydown",e)},getCurrentInput:function(e){return e},getClassStringFromListItem:function(e){return"."===e.firstElementChild.textContent.charAt(0)?e.firstElementChild.textContent.slice(1):e.firstElementChild.textContent},getExcludedInputSelectors:function(){return"#title, #url, #ariaLabel, #rel, #text, #bricks-panel-search, .external-url, #videoUrl, #cssSelector, #_cssClasses, #_cssId, div[data-control='conditions']"},displayValuePreview:function(e,t,r){var o=Builder.getCurrentCssProperty(t),n=this.getCurrentSelector();o?r.innerHTML=n+` {${o}: ${e}}`:(t.value=e,t.dispatchEvent(new Event("input")))},removeValuePreview:function(e,t){t.innerHTML=""},setValue:function(e,t){t.value=e,t.dispatchEvent(new Event("input"))}},oxygenFunctions={name:"oxygen",getIframeDocument:()=>document.getElementById("ct-artificial-viewport").contentWindow.document,mainInputSelector:".oxygen-active-selector-box",mainPanelSelector:"#oxygen-sidebar",classInputSelector:".oxygen-classes-dropdown-input",saveClassSelector:".input-wrapper .actions .create",getCurrentElementId:function(){return"#"+$scope.iframeScope.findComponentItem($scope.iframeScope.componentsTree.children,$scope.iframeScope.component.active.id,$scope.iframeScope.getComponentItem).options.selector},addClass:function(e){this.removePreviewClass(e),$scope.iframeScope.addSuggestedClassToComponent(e)},removeClass:function(e){$scope.iframeScope.removeComponentClass(e)},isClassAlreadyActive:function(e){if($scope.iframeScope.findComponentItem($scope.iframeScope.componentsTree.children,$scope.iframeScope.component.active.id,$scope.iframeScope.getComponentItem).options.classes)return $scope.iframeScope.findComponentItem($scope.iframeScope.componentsTree.children,$scope.iframeScope.component.active.id,$scope.iframeScope.getComponentItem).options.classes.includes(e)},initHoverPreviewEventImplementation:e=>{document.querySelector(".oxygen-classes-dropdown-input").addEventListener("input",function(){null!=document.querySelector(".oxygen-classes-suggestions > li:first-child")&&e()})},getUnusedClassListItems:function(){return document.querySelectorAll(".oxygen-classes-suggestions > li")},getClassStringFromListItem:function(e){return e.lastElementChild.textContent},getCurrentInputOption:e=>{var t=e.getAttribute("data-option");return null!=t?t:!(!e.previousElementSibling||!e.previousElementSibling.classList.contains("oxygen-color-picker-color"))&&"color"},setUnitToNone:function(e){var t=this.getCurrentInputOption(e);e.parentElement.querySelector(".oxygen-measure-box-units")&&t&&$scope.iframeScope.setOptionUnit(t," ")},getCurrentInput:function(e){return e},getCurrentSelector:function(){return!1},getCurrentCssProperty:function(e){return!1},getExcludedInputSelectors:function(){return".oxygen-file-input"},displayValuePreview:function(e,t,r){t.value=e,console.log("preview"),t.dispatchEvent(new Event("input"))},removeValuePreview:function(e,t){e.value="",console.log("remove"),e.dispatchEvent(new Event("input"))},setValue:function(e,t){t.value=e,console.log("add"),t.dispatchEvent(new Event("input"))}},gutenbergFunctions={name:"gutenberg",getIframeDocument:()=>document.querySelector("iframe[name='editor-canvas']")?document.querySelector("iframe[name='editor-canvas']").contentWindow.document:document.querySelector(".edit-post-visual-editor__content-area"),mainInputSelector:".acss-class-input input",mainPanelSelector:".interface-navigable-region.interface-interface-skeleton__sidebar",classInputSelector:".acss-class-input input",getCurrentElementId:function(){return"#block-"+wp.data.select("core/block-editor").getSelectedBlock().clientId},addClass:function(e){this.removePreviewClass(e);var t=wp.data.select("core/block-editor").getSelectedBlock(),e={...t.attributes,className:(`${t.attributes.className??""} `+e).trim()};wp.data.dispatch("core/block-editor").updateBlockAttributes(t.clientId,e)},removeClass:function(e){var t=wp.data.select("core/block-editor").getSelectedBlock(),r=t.attributes.className,e=new RegExp("\\b\\s*"+e+"\\s*\\b","g"),r=r.replace(e,"").trim(),e={...t.attributes,className:""+r};wp.data.dispatch("core/block-editor").updateBlockAttributes(t.clientId,e)},isClassAlreadyActive:function(e){return(wp.data.select("core/block-editor").getSelectedBlock().attributes.className?.split(" ")??[]).includes(e)},getCurrentInputOption:()=>!1,setUnitToNone:()=>{},initHoverPreviewEventImplementation:e=>{},getCurrentInput:function(e){return e},getCurrentSelector:function(){return this.getCurrentElementId()},getCurrentCssProperty:function(e){if(!e.classList.contains("gblocks-color-component__toggle-indicator"))return"gblocks-"===e.id.slice(0,8)?this.toKebapCase(this.toCamelCase(e.id.slice(8))):this.toKebapCase(this.toCamelCase(e.id));var t=e.closest(".gblocks-color-component");if(e.closest(".gblocks-border-colors"))return r=e.closest(".gblocks-flex-control").querySelector(".components-text-control__input").id.match(/border([a-zA-Z]+)-/)[1].toLowerCase(),t.previousElementSibling?.classList.contains("gblocks-color-component")?`border-${r}-color-hover`:`border-${r}-color`;var r=e.closest(".gblocks-color-group__row"),e=r?.querySelector(".gblocks-color-group__row-label")?.textContent;if(e&&r){if(t.previousElementSibling?.classList.contains("gblocks-color-component"))switch(e){case"Background":return"background-color-hover";case"Text":return"color-hover";case"Link":return"link-color-hover"}switch(e){case"Background":return"background-color";case"Text":return"color";case"Link":return"link-color"}}return!1},toCamelCase:e=>e.replace(/-./g,e=>e[1].toUpperCase()),toKebapCase:e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),getExcludedInputSelectors:function(){return"#thisisjustaplaceholder"},getVarSections:function(e){e=getTypeOfCssProperty(this.getCurrentCssProperty(e));switch(console.log(e),e){case"typography":return["typography"];case"spacing":return["spacing","section","button","frames-card"];case"radius":return["radius","button","frames-card"];case"width":return["width"];case"grid":return["grid"];case"colors":return["colors"];case"height":return["height"];default:return[""]}},getCategoryFromCssProperty:function(){const t=new Map;return["font-size","font-family","font-weight","line-height","letter-spacing"].forEach(e=>t.set(e,"typography")),["border-top-left-radius","border-bottom-left-radius","border-top-right-radius","border-bottom-right-radius","border-top-width","border-left-width","border-bottom-width","border-right-width","border-top-color","border-left-color","border-bottom-color","border-right-color","border-top-color-hover","border-left-color-hover","border-bottom-color-hover","border-right-color-hover"].forEach(e=>t.set(e,"borders")),["margin-top","margin-left","margin-right","margin-bottom","padding-top","padding-left","padding-right","padding-bottom"].forEach(e=>t.set(e,"spacing")),["width","height","min-width","min-height","max-height","max-width"].forEach(e=>t.set(e,"sizing")),["color","background-color","link-color","color-hover","background-color-hover","link-color-hover"].forEach(e=>t.set(e,"colors")),function(e){return t.get(e)}}(),setCssProperty:function(e,t){var r=wp.data.select("core/block-editor").getSelectedBlock(),o=this.getCategoryFromCssProperty(e);let n={...r.attributes};var s=document.querySelector(".gb-responsive-tabs");let i="";s.querySelector("button.is-pressed:nth-child(2)")?i="Tablet":s.querySelector("button.is-pressed:nth-child(3)")&&(i="Mobile"),e+=i,"colors"===o?("color"===e&&(e="textColor"),n={...r.attributes,[this.toCamelCase(e)]:t}):n[o]={...r.attributes[o],[this.toCamelCase(e)]:t},console.log(r.attributes),console.log(n),wp.data.dispatch("core/block-editor").updateBlockAttributes(r.clientId,n)},displayValuePreview:function(e,t,r){var o=this.getCurrentSelector();let n=this.getCurrentCssProperty(t);n&&("hover"===n.slice(-5)&&(n=n.slice(0,n.length-6)),r.innerHTML=`${o} {${n}: ${e}}`)},removeValuePreview:function(e,t){t.innerHTML=""},setValue:function(e,t){t=this.getCurrentCssProperty(t);this.setCssProperty(t,e)}},builderFunctions={},Builder=(builderFunctions=document.getElementById("ct-artificial-viewport")?oxygenFunctions:document.querySelector(".brx-body")?bricksFunctions:gutenbergFunctions,{...sharedFunctions,...builderFunctions});export{Builder};